<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#">
<head>
<meta charset="utf-8">
<meta content="A quick walk-through of a Natural Language Processing work-flow." name="description">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Newsgroups Example | Tip of the Dnghu</title>
<link href="../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<meta content="Nikola (getnikola.com)" name="generator">
<link href="../../../rss.xml" rel="alternate" title="RSS" type="application/rss+xml">
<link href="https://necromuralist.github.io/Tip-of-the-Dnghu/posts/nlp/newsgroups-example/" rel="canonical"><!--[if lt IE 9]><script src="../../../assets/js/html5.js"></script><![endif]-->
<link href="../../../apple-touch-icon.png" rel="apple-touch-icon" sizes="180x180">
<link href="../../../favicon-32x32.png" rel="icon" sizes="32x32" type="image/png">
<link href="../../../favicon-16x16.png" rel="icon" sizes="16x16" type="image/png">
<link href="../../../site.webmanifest" rel="manifest">
<script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>
<meta content="Cloistered Monkey" name="author">
<link href="../../text_mining/the-vector-space-model/" rel="prev" title="The Vector Space Model" type="text/html">
<meta content="Tip of the Dnghu" property="og:site_name">
<meta content="Newsgroups Example" property="og:title">
<meta content="https://necromuralist.github.io/Tip-of-the-Dnghu/posts/nlp/newsgroups-example/" property="og:url">
<meta content="A quick walk-through of a Natural Language Processing work-flow." property="og:description">
<meta content="article" property="og:type">
<meta content="2019-05-16T12:41:32-07:00" property="article:published_time">
<meta content="nlp" property="article:tag">
<meta content="walk-through" property="article:tag">
</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a> <!-- Menubar -->
<nav class="navbar navbar-expand-md static-top mb-4 navbar-light bg-light">
<div class="container"><!-- This keeps the margins nice -->
 <a class="navbar-brand" href="https://necromuralist.github.io/Tip-of-the-Dnghu/"><span id="blog-title">Tip of the Dnghu</span></a> <button aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler" data-target="#bs-navbar" data-toggle="collapse" type="button"><span class="navbar-toggler-icon"></span></button>
<div class="collapse navbar-collapse" id="bs-navbar">
<ul class="navbar-nav mr-auto">
<li class="nav-item"><a class="nav-link" href="../../../archive.html">Archive</a></li>
<li class="nav-item"><a class="nav-link" href="../../../categories/">Tags</a></li>
<li class="nav-item"><a class="nav-link" href="../../../rss.xml">RSS feed</a></li>
<li class="nav-item dropdown"><a aria-expanded="false" aria-haspopup="true" class="nav-link dropdown-toggle" data-toggle="dropdown" href="#">Pages</a>
<div class="dropdown-menu"><a class="dropdown-item" href="https://necromuralist.github.io/">Cloistered Monkey</a></div>
</li>
</ul>
<!-- DuckDuckGo custom search -->
<form action="https://duckduckgo.com/" class="navbar-form pull-left" id="search" method="get" name="search"><input name="sites" type="hidden" value="https://necromuralist.github.io/Tip-of-the-Dnghu/"><input name="k8" type="hidden" value="#444444"><input name="k9" type="hidden" value="#D51920"><input name="kt" type="hidden" value="h"><input class="span2" maxlength="255" name="q" placeholder="Searchâ€¦" type="text"><input style="visibility: hidden;display:none" type="submit" value="DuckDuckGo Search"></form>
<!-- End of custom search -->
<ul class="navbar-nav navbar-right">
<li class="nav-item"><a class="nav-link" href="index.org" id="sourcelink">Source</a></li>
</ul>
</div>
<!-- /.navbar-collapse --></div>
<!-- /.container --></nav>
<!-- End of Menubar -->
<div class="container" id="content" role="main">
<div class="body-content"><!--Body content-->
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article">
<header>
<h1 class="p-name entry-title" itemprop="headline name"><a class="u-url" href=".">Newsgroups Example</a></h1>
<div class="metadata">
<p class="byline author vcard"><span class="byline-name fn" itemprop="author">Cloistered Monkey</span></p>
<p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2019-05-16T12:41:32-07:00" itemprop="datePublished" title="2019-05-16 12:41">2019-05-16 12:41</time></a></p>
<p class="sourceline"><a class="sourcelink" href="index.org">Source</a></p>
</div>
</header>
<div class="e-content entry-content" itemprop="articleBody text">
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org3dc6ad1">Beginning</a>
<ul>
<li><a href="#orgca01d55">Imports</a></li>
<li><a href="#org56859b4">Set Up</a></li>
</ul>
</li>
<li><a href="#org38db32c">Middle</a>
<ul>
<li><a href="#orga3d3ce8">Loading the Data</a></li>
<li><a href="#org28dbe84">Setting Up The Test Set</a></li>
<li><a href="#org3c0c5a6">The Document Term Matrix</a></li>
<li><a href="#org82b9184">Term-Frequency/Inverse Document Frequency</a></li>
<li><a href="#org17473d9">A Logistic Regression Pipeline</a></li>
<li><a href="#org1ce9dea">Cross Validation</a></li>
<li><a href="#org926b5f5">Testing</a></li>
<li><a href="#orgde6c361">A Confusion Matrix</a></li>
</ul>
</li>
<li><a href="#org7d45ad6">End</a>
<ul>
<li><a href="#orga2b6c8e">Original Source</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="outline-2" id="outline-container-org3dc6ad1">
<h2 id="org3dc6ad1">Beginning</h2>
<div class="outline-text-2" id="text-org3dc6ad1">
<p>This is going to be a look at the <a href="https://archive.ics.uci.edu/ml/datasets/twenty+newsgroups">Twenty Newsgroups</a> dataset which has posts from twenty newsgroups classified by the newsgroup that they were in. It will be sort of a mad-dash through a simple pipeline to create a model that can classify them.</p>
</div>
<div class="outline-3" id="outline-container-orgca01d55">
<h3 id="orgca01d55">Imports</h3>
<div class="outline-text-3" id="text-orgca01d55"></div>
<div class="outline-4" id="outline-container-orgc2f087b">
<h4 id="orgc2f087b">Python</h4>
<div class="outline-text-4" id="text-orgc2f087b">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgd6b1d0e">
<h4 id="orgd6b1d0e">PyPi</h4>
<div class="outline-text-4" id="text-orgd6b1d0e">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">dotenv</span> <span class="kn">import</span> <span class="n">load_dotenv</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">fetch_20newsgroups</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_extraction.text</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">CountVectorizer</span><span class="p">,</span> 
    <span class="n">TfidfTransformer</span><span class="p">,</span>
    <span class="n">TfidfVectorizer</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">confusion_matrix</span><span class="p">,</span> 
    <span class="n">f1_score</span><span class="p">,</span> 
    <span class="n">precision_score</span><span class="p">,</span> 
    <span class="n">recall_score</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">cross_val_score</span><span class="p">,</span> 
    <span class="n">train_test_split</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">tabulate</span> <span class="kn">import</span> <span class="n">tabulate</span>
<span class="kn">import</span> <span class="nn">holoviews</span>
<span class="kn">import</span> <span class="nn">hvplot.pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org5089e8e">
<h4 id="org5089e8e">My Stuff</h4>
<div class="outline-text-4" id="text-org5089e8e">
<div class="highlight">
<pre><span></span><span class="kn">from</span> <span class="nn">graeae.tables</span> <span class="kn">import</span> <span class="n">CountPercentage</span>
<span class="kn">from</span> <span class="nn">graeae.timers</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">graeae.visualization</span> <span class="kn">import</span> <span class="n">EmbedHoloview</span>
</pre></div>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org56859b4">
<h3 id="org56859b4">Set Up</h3>
<div class="outline-text-3" id="text-org56859b4"></div>
<div class="outline-4" id="outline-container-org3136005">
<h4 id="org3136005">Load the Dotenv</h4>
<div class="outline-text-4" id="text-org3136005">
<p>This loads some extra environment variables, in particular the path to the sklearn-data folder.</p>
<div class="highlight">
<pre><span></span><span class="n">dotenv_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">"~/.env"</span><span class="p">)</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>
<span class="n">load_dotenv</span><span class="p">(</span><span class="n">dotenv_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orgbf10836">
<h4 id="orgbf10836">The Timer</h4>
<div class="outline-text-4" id="text-orgbf10836">
<p>This is an object to keep track of how long things take.</p>
<div class="highlight">
<pre><span></span><span class="n">TIMER</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-orge0b9b0c">
<h4 id="orge0b9b0c">The Table</h4>
<div class="outline-text-4" id="text-orge0b9b0c">
<p>This is a helper to print org-tables from data-frames.</p>
<div class="highlight">
<pre><span></span><span class="n">TABLE</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">tabulate</span><span class="p">,</span> <span class="n">tablefmt</span><span class="o">=</span><span class="s2">"orgtbl"</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="s2">"keys"</span><span class="p">,</span>
                <span class="n">showindex</span><span class="o">=</span><span class="s2">"false"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="outline-4" id="outline-container-org191cf3e">
<h4 id="org191cf3e">Plotting</h4>
<div class="outline-text-4" id="text-org191cf3e">
<p>This helps save the plots to the right folder for nikola.</p>
<div class="highlight">
<pre><span></span><span class="n">SLUG</span> <span class="o">=</span> <span class="s2">"newsgroups-example"</span>
<span class="n">Embed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">EmbedHoloview</span><span class="p">,</span> <span class="n">folder_path</span><span class="o">=</span><span class="s2">"../../files/posts/nlp/"</span> <span class="o">+</span> <span class="n">SLUG</span><span class="p">)</span>
<span class="n">holoviews</span><span class="o">.</span><span class="n">extension</span><span class="p">(</span><span class="s2">"bokeh"</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org38db32c">
<h2 id="org38db32c">Middle</h2>
<div class="outline-text-2" id="text-org38db32c"></div>
<div class="outline-3" id="outline-container-orga3d3ce8">
<h3 id="orga3d3ce8">Loading the Data</h3>
<div class="outline-text-3" id="text-orga3d3ce8">
<p>We're going to be using the <a href="https://scikit-learn.org/0.19/datasets/twenty_newsgroups.html">20 Newsgroups dataset</a> that you can download using sklearn's <a href="https://scikit-learn.org/0.19/modules/generated/sklearn.datasets.fetch_20newsgroups.html#sklearn.datasets.fetch_20newsgroups">fetch_20newsgroups</a> function. By default it downloads it to a folder named <code>scikit_learn_data</code> in your home directory, but since <i>everybody</i> seems to want to add folders to my home directory I prefer to put it in a hidden folder so I'm not always staring at all these folders. To make it more likely that I'll remember the right folder name I put it in an environment variable.</p>
<div class="highlight">
<pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"SKLEARN"</span><span class="p">))</span><span class="o">.</span><span class="n">expanduser</span><span class="p">()</span>

<span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">dataset</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">data_home</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
</pre></div>
<pre class="example">
2019-05-18 10:39:58,412 graeae.timers.timer start: Started: 2019-05-18 10:39:58.412167
Downloading 20news dataset. This may take a few minutes.
Downloading dataset from https://ndownloader.figshare.com/files/5975967 (14 MB)
2019-05-18 10:40:33,263 graeae.timers.timer end: Ended: 2019-05-18 10:40:33.263259
2019-05-18 10:40:33,263 graeae.timers.timer end: Elapsed: 0:00:34.851092

</pre>
<p>The <code>dataset</code> is an sklearn bunch - a dictionary-like object (but like pandas you can also use dot-notation to access the values).</p>
<div class="highlight">
<pre><span></span><span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">" - {key}"</span><span class="p">)</span>
</pre></div>
<ul class="org-ul">
<li>data</li>
<li>filenames</li>
<li>target_names</li>
<li>target</li>
<li>DESCR</li>
</ul>
<p>The <code>data</code> is the inputs and the <code>target</code> is the labels for each input.</p>
<p>The description is really long, but we can look at part of it to get some idea of what's in the data-set.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">"#+begin_src rst"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">DESCR</span><span class="p">[:</span><span class="mi">1085</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="s2">"#+end_src"</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span>.. _20newsgroups_dataset:

The 20 newsgroups text dataset
------------------------------

The 20 newsgroups dataset comprises around 18000 newsgroups posts on
20 topics split in two subsets: one for training (or development)
and the other one for testing (or for performance evaluation). The split
between the train and test set is based upon a messages posted before
and after a specific date.

This module contains two loaders. The first one,
:func:`sklearn.datasets.fetch_20newsgroups`,
returns a list of the raw texts that can be fed to text feature
extractors such as :class:`sklearn.feature_extraction.text.CountVectorizer`
with custom parameters so as to extract feature vectors.
The second one, :func:`sklearn.datasets.fetch_20newsgroups_vectorized`,
returns ready-to-use features, i.e., it is not necessary to use a feature
extractor.

**Data Set Characteristics:**

    =================   ==========
    Classes                     20
    Samples total            18846
    Dimensionality               1
    Features                  text
    =================   ==========
</pre></div>
<p>So, reading the blob the first thing to notice is that they already split the dataset into training and testing sets - even though I didn't specify anything all I really got was the training set.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org28dbe84">
<h3 id="org28dbe84">Setting Up The Test Set</h3>
<div class="outline-text-3" id="text-org28dbe84">
<p>Normally I would use sklearn's <a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">train_test_split</a> to split the data set up, but since they set it up so that you have to download the test set separately, I guess I'll go with that.</p>
<div class="highlight">
<pre><span></span><span class="n">test_set</span> <span class="o">=</span> <span class="n">fetch_20newsgroups</span><span class="p">(</span><span class="n">data_home</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="s2">"test"</span><span class="p">)</span>
<span class="n">x_train</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">data</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">target</span>
<span class="n">x_test</span> <span class="o">=</span> <span class="n">test_set</span><span class="o">.</span><span class="n">data</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">test_set</span><span class="o">.</span><span class="n">target</span>
<span class="n">train_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<span class="n">test_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="n">total_count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_set</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Training: {train_count:,} "</span>
      <span class="n">f</span><span class="s2">"({100 * train_count /total_count:.0f} %)"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Testing: {test_count:,} ({100 * test_count/total_count:.0f} %)"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Training: 11,314 (60 %)
Testing: 7,532 (40 %)

</pre></div>
<div class="outline-4" id="outline-container-orgcb041e0">
<h4 id="orgcb041e0">What does an entry look like?</h4>
<div class="outline-text-4" id="text-orgcb041e0">
<div class="highlight">
<pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="nb">min</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="n">index</span><span class="p">])</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x_train</span><span class="p">))))</span>
<span class="k">print</span><span class="p">(</span><span class="n">x_train</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
</pre></div>
<pre class="example">
From: joachim@kih.no (joachim lous)
Subject: Re: TIFF: philosophical significance of 42
Organization: Kongsberg Ingeniorhogskole
Lines: 30
NNTP-Posting-Host: samson.kih.no
X-Newsreader: TIN [version 1.1 PL8]

ulrich@galki.toppoint.de wrote:

&gt; According to the TIFF 5.0 Specification, the TIFF "version number"
&gt; (bytes 2-3) 42 has been chosen for its "deep philosophical 
&gt; significance".

&gt; When I first read this, I rotfl. Finally some philosphy in a technical
&gt; spec. But still I wondered what makes 42 so significant.

&gt; Last week, I read the Hitchhikers Guide To The Galaxy, and rotfl the
&gt; second time. (After millions of years of calculation, the second-best
&gt; computer of all time reveals that 42 is the answer to the question
&gt; about life, the universe and everything)

&gt; Is this actually how they picked the number 42?

Yes.

&gt; Does anyone have any  other suggestions where the 42 came from?

I don't know where Douglas Adams took it from, but I'm pretty sure he's
the one who launched it (in the Guide). Since then it's been showing up 
all over the place.

    _______________________________
   / _ L*   /  _  / .    /      _  /_  "One thing is for sure: The sheep
  /  _)    /()(/(/)//)) /_ ()(/_) / /  Is NOT a creature of the earth."
 / \_)~  (/ Joachim@kih.no       / /     
/_______________________________/ / -The back-masking on 'Haaden II'
 /_______________________________/  from 'Exposure' by Robert Fripp.

</pre>
<p>Looks like there's a lot of noise in these things.</p>
</div>
</div>
<div class="outline-4" id="outline-container-org919a007">
<h4 id="org919a007">How are the groups distributed?</h4>
<div class="outline-text-4" id="text-org919a007">
<p>The labels are numbers representing which Newsgroup each of the documents came from, but they also give us a translation in the form of the <code>dataset.target_names</code> list so we can take a look at how much of each group is represented.</p>
<div class="highlight">
<pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="p">{</span><span class="n">index</span><span class="p">:</span> <span class="n">name</span> <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">target_names</span><span class="p">)}</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="n">Y</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
<span class="n">y_count</span> <span class="o">=</span> <span class="n">CountPercentage</span><span class="p">(</span><span class="n">Y</span><span class="p">,</span> <span class="n">value_label</span><span class="o">=</span><span class="s2">"Newsgroup"</span><span class="p">)</span>
<span class="n">y_count</span><span class="p">()</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Newsgroup</th>
<th class="org-right" scope="col">Count</th>
<th class="org-right" scope="col">Percent (%)</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">rec.sport.hockey</td>
<td class="org-right">600</td>
<td class="org-right">5.30</td>
</tr>
<tr>
<td class="org-left">soc.religion.christian</td>
<td class="org-right">599</td>
<td class="org-right">5.29</td>
</tr>
<tr>
<td class="org-left">rec.motorcycles</td>
<td class="org-right">598</td>
<td class="org-right">5.29</td>
</tr>
<tr>
<td class="org-left">rec.sport.baseball</td>
<td class="org-right">597</td>
<td class="org-right">5.28</td>
</tr>
<tr>
<td class="org-left">sci.crypt</td>
<td class="org-right">595</td>
<td class="org-right">5.26</td>
</tr>
<tr>
<td class="org-left">rec.autos</td>
<td class="org-right">594</td>
<td class="org-right">5.25</td>
</tr>
<tr>
<td class="org-left">sci.med</td>
<td class="org-right">594</td>
<td class="org-right">5.25</td>
</tr>
<tr>
<td class="org-left">comp.windows.x</td>
<td class="org-right">593</td>
<td class="org-right">5.24</td>
</tr>
<tr>
<td class="org-left">sci.space</td>
<td class="org-right">593</td>
<td class="org-right">5.24</td>
</tr>
<tr>
<td class="org-left">sci.electronics</td>
<td class="org-right">591</td>
<td class="org-right">5.22</td>
</tr>
<tr>
<td class="org-left">comp.os.ms-windows.misc</td>
<td class="org-right">591</td>
<td class="org-right">5.22</td>
</tr>
<tr>
<td class="org-left">comp.sys.ibm.pc.hardware</td>
<td class="org-right">590</td>
<td class="org-right">5.21</td>
</tr>
<tr>
<td class="org-left">misc.forsale</td>
<td class="org-right">585</td>
<td class="org-right">5.17</td>
</tr>
<tr>
<td class="org-left">comp.graphics</td>
<td class="org-right">584</td>
<td class="org-right">5.16</td>
</tr>
<tr>
<td class="org-left">comp.sys.mac.hardware</td>
<td class="org-right">578</td>
<td class="org-right">5.11</td>
</tr>
<tr>
<td class="org-left">talk.politics.mideast</td>
<td class="org-right">564</td>
<td class="org-right">4.98</td>
</tr>
<tr>
<td class="org-left">talk.politics.guns</td>
<td class="org-right">546</td>
<td class="org-right">4.83</td>
</tr>
<tr>
<td class="org-left">alt.atheism</td>
<td class="org-right">480</td>
<td class="org-right">4.24</td>
</tr>
<tr>
<td class="org-left">talk.politics.misc</td>
<td class="org-right">465</td>
<td class="org-right">4.11</td>
</tr>
<tr>
<td class="org-left">talk.religion.misc</td>
<td class="org-right">377</td>
<td class="org-right">3.33</td>
</tr>
</tbody>
</table>
<p>So, there isn't too much of a spread, although religion (other than Christianity and Microsoft Windows) and politics are a little less represented.</p>
<div class="highlight">
<pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">y_count</span><span class="o">.</span><span class="n">table</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">"Newsgroup"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">"Count"</span><span class="p">)</span><span class="o">.</span><span class="n">opts</span><span class="p">(</span>
    <span class="n">title</span><span class="o">=</span><span class="s2">"Newsgroup Counts"</span><span class="p">,</span> <span class="n">xrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s2">"crosshair"</span><span class="p">,</span> <span class="s2">"hover"</span><span class="p">])</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"newsgroups_count"</span><span class="p">)()</span>
</pre></div>
<object data="newsgroups_count.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p>Actually, now that I plot it it looks like the last three are underepresented, especially when compared to hockey (some kind of Canadian bias?).</p>
</div>
</div>
</div>
<div class="outline-3" id="outline-container-org3c0c5a6">
<h3 id="org3c0c5a6">The Document Term Matrix</h3>
<div class="outline-text-3" id="text-org3c0c5a6">
<p>To work with the data-set we need to convert it to some kind of numeric value. In this case I'm going to use sklearn's <a href="https://scikit-learn.org/0.19/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html#sklearn.feature_extraction.text.CountVectorizer">CountVectorizer</a> to create a matrix where each row represents a document and each column is a term in the <a href="https://www.wikiwand.com/en/Text_corpus">corpus</a> (creating a <a href="https://www.wikiwand.com/en/Bag-of-words_model">Bag of Words</a>/<a href="https://www.wikiwand.com/en/Document-term_matrix">Document Term Matrix</a>) The values are the count of the terms in each document. Sklearn has an alternative download function - <a href="https://scikit-learn.org/0.19/modules/generated/sklearn.datasets.fetch_20newsgroups_vectorized.html#sklearn.datasets.fetch_20newsgroups_vectorized">fetch_20newsgroups_vectorized</a> that will download it already vectorized, but since you have to do the conversion yourself in most cases I thought it would be better not to use it.</p>
<div class="highlight">
<pre><span></span><span class="n">vectorizer</span> <span class="o">=</span> <span class="n">CountVectorizer</span><span class="p">()</span>
<span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">x_train_vectorized</span> <span class="o">=</span> <span class="n">vectorizer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
</pre></div>
<pre class="example">
2019-05-18 16:17:56,875 graeae.timers.timer start: Started: 2019-05-18 16:17:56.875200
2019-05-18 16:17:58,628 graeae.timers.timer end: Ended: 2019-05-18 16:17:58.628334
2019-05-18 16:17:58,628 graeae.timers.timer end: Elapsed: 0:00:01.753134

</pre>
<p>That was quicker than I thought it would be - I guess the data set isn't that large.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">x_train_vectorized</span><span class="p">))</span>
<span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">x_train_vectorized</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Documents: {rows:,} Terms: {columns:,}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
&lt;class 'scipy.sparse.csr.csr_matrix'&gt;
Documents: 11,314 Terms: 130,107

</pre>
<p>I was going to inspect the matrix, but it's a sparse matrix so you have to convert it to another type to inspect it, and all it would be is a matrix of numbers (term counts) so I'll leave it for some other time.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org82b9184">
<h3 id="org82b9184">Term-Frequency/Inverse Document Frequency</h3>
<div class="outline-text-3" id="text-org82b9184">
<p>If we just use the counts (the Term-Frequency (TF)), then the most common word per document will have the highest value, but if a word is spread across all or at least many documents, then even if it's common in a document it probably won't help us distinguish the documents from each other in a meaningful way. To deal with this we can add a penalty (the Inverse-Document-Frequency (IDF) weight) that lowers the value for a term the more common it is among all the documents. Together the two methods are knows as <a href="https://www.wikiwand.com/en/Tf%E2%80%93idf">TF-IDF.</a> Here sklearn's <a href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfTransformer.html">TfidfTransformer</a> does the transform for us.</p>
<div class="highlight">
<pre><span></span><span class="n">transformer</span> <span class="o">=</span> <span class="n">TfidfTransformer</span><span class="p">()</span>
<span class="n">x_train_tfidf</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train_vectorized</span><span class="p">)</span>
<span class="n">rows</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="n">x_train_tfidf</span><span class="o">.</span><span class="n">shape</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Documents: {rows:,} Terms: {columns:,}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Documents: 11,314 Terms: 130,107

</pre></div>
</div>
<div class="outline-3" id="outline-container-org17473d9">
<h3 id="org17473d9">A Logistic Regression Pipeline</h3>
<div class="outline-text-3" id="text-org17473d9">
<p>To classify the documents we're going to use <a href="https://www.wikiwand.com/en/Logistic_regression">Logistic Regression</a> (also from <a href="https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LogisticRegression.html">sklearn</a>). In addition, instead of creating the Document Term Matrix in separate steps as above, I'm going to create a <a href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html">Pipeline</a> so sklearn can do it in a single call. An sklearn Pipeline takes as all but the last of it's constructor's argument a list of <code>(name, transform)</code> tuples, where the <code>transform</code> argument is an object that has a <code>fit_transform</code> method (like the <code>CountVectorizer</code> we saw earlier). The last of argument of the constructor is the model that you are going to fit on the data that the pipeline has transformed. If you don't want to customize the names there's a <a href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.make_pipeline.html#sklearn.pipeline.make_pipeline">make_pipeline</a> function that just takes the transformer and model instances as arguments and automatically names them for you, returning the pipeline as its output.</p>
<p>I used the <code>CountVectorizer</code> followed by the <code>TfidfTransformer</code> to show them separately, but sklearn actually has a <a href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html">TfidfVectorizer</a> class that does both of them for you so I'll use that here.</p>
<div class="highlight">
<pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s2">"TF-IDF"</span><span class="p">,</span> <span class="n">TfidfVectorizer</span><span class="p">()),</span> 
                  <span class="p">(</span><span class="s2">"Logistic Regression"</span><span class="p">,</span> <span class="n">LogisticRegression</span><span class="p">(</span>
                      <span class="n">solver</span><span class="o">=</span><span class="s2">"lbfgs"</span><span class="p">,</span>
                      <span class="n">multi_class</span><span class="o">=</span><span class="s2">"multinomial"</span><span class="p">))])</span>
</pre></div>
<p>I'm using the defaults for Logistic Regression in general, but it will output a lot of warnings if you don't set the solver and multi-class. I'm using the <a href="https://www.wikiwand.com/en/Limited-memory_BFGS">Limited-Memory Broyden-Fletcher-Goldfarb-Shanno</a> algorithm for the solver and setting the <code>multi_class</code> to "multinomial" (setting it to "auto" would do the same thing since there is more than one document-classification, rather than being a binary classification problem).</p>
</div>
</div>
<div class="outline-3" id="outline-container-org1ce9dea">
<h3 id="org1ce9dea">Cross Validation</h3>
<div class="outline-text-3" id="text-org1ce9dea">
<p>Now we can do some cross validation.</p>
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">scores</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> 
                             <span class="n">scoring</span><span class="o">=</span><span class="s2">"f1_macro"</span><span class="p">)</span>
</pre></div>
<pre class="example">
2019-05-18 16:18:23,392 graeae.timers.timer start: Started: 2019-05-18 16:18:23.392913
2019-05-18 16:22:00,933 graeae.timers.timer end: Ended: 2019-05-18 16:22:00.933407
2019-05-18 16:22:00,934 graeae.timers.timer end: Elapsed: 0:03:37.540494

</pre>
<p>So this took a little bit longer than I thought it might, although it wasn't too long.</p>
<div class="highlight">
<pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
<span class="n">description</span> <span class="o">=</span> <span class="n">scores</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">description</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">"Statistic"</span><span class="p">,</span> <span class="s2">"Value"</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">TABLE</span><span class="p">(</span><span class="n">description</span><span class="p">))</span>
</pre></div>
<table border="2" cellpadding="6" cellspacing="0" frame="hsides" rules="groups">
<colgroup>
<col class="org-left">
<col class="org-right"></colgroup>
<thead>
<tr>
<th class="org-left" scope="col">Statistic</th>
<th class="org-right" scope="col">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">count</td>
<td class="org-right">7</td>
</tr>
<tr>
<td class="org-left">mean</td>
<td class="org-right">0.895705</td>
</tr>
<tr>
<td class="org-left">std</td>
<td class="org-right">0.00459816</td>
</tr>
<tr>
<td class="org-left">min</td>
<td class="org-right">0.88992</td>
</tr>
<tr>
<td class="org-left">25%</td>
<td class="org-right">0.892157</td>
</tr>
<tr>
<td class="org-left">50%</td>
<td class="org-right">0.89517</td>
</tr>
<tr>
<td class="org-left">75%</td>
<td class="org-right">0.900081</td>
</tr>
<tr>
<td class="org-left">max</td>
<td class="org-right">0.90037</td>
</tr>
</tbody>
</table>
<p>It looks like even with the default parameters the model got a mean/median <a href="https://www.wikiwand.com/en/F1_score">F1 Score</a> of 90 %, with a standard deviation of 0.0046, so the variance is pretty low.</p>
</div>
</div>
<div class="outline-3" id="outline-container-org926b5f5">
<h3 id="org926b5f5">Testing</h3>
<div class="outline-text-3" id="text-org926b5f5">
<p>Let's try fitting it to the whole training set and see how it does.</p>
<div class="highlight">
<pre><span></span><span class="k">with</span> <span class="n">TIMER</span><span class="p">:</span>
    <span class="n">fitted</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
<pre class="example">
2019-05-18 16:23:58,703 graeae.timers.timer start: Started: 2019-05-18 16:23:58.703461
2019-05-18 16:24:33,056 graeae.timers.timer end: Ended: 2019-05-18 16:24:33.056510
2019-05-18 16:24:33,057 graeae.timers.timer end: Elapsed: 0:00:34.353049

</pre>
<div class="highlight">
<pre><span></span><span class="n">predictions</span> <span class="o">=</span> <span class="n">fitted</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"F1 Score: {f1_score(y_test, predictions, average='weighted'):.2f}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
F1 Score: 0.83

</pre>
<p>The F1 score in the test-set was lower than the maximum score for our cross-validation checks, so it may have over-fit the training set - or, since they used time to split the sets, the training set might not really represent the test set.</p>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span>
    <span class="s2">"Precision: "</span>
    <span class="n">f</span><span class="s2">"{precision_score(y_test, predictions, average='weighted'):.2f}"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span>
    <span class="s2">"Recall: "</span>
    <span class="n">f</span><span class="s2">"{recall_score(y_test, predictions, average='weighted'):.2f}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Precision: 0.83
Recall: 0.83

</pre>
<p>The precision and recall are the same as the F1 score, so it isn't better at either (or it's good at both, your pick).</p>
</div>
</div>
<div class="outline-3" id="outline-container-orgde6c361">
<h3 id="orgde6c361">A Confusion Matrix</h3>
<div class="outline-text-3" id="text-orgde6c361">
<p>Having a single value like the F1 score helps us evaluate the model, but using a <a href="https://www.wikiwand.com/en/Confusion_matrix">Confusion Matrix</a> (via sklearn's <a href="https://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html">confusion_matrix</a> function) will help us understand how the model did a little more.</p>
<div class="highlight">
<pre><span></span><span class="n">confusion</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="o">=</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="o">=</span><span class="n">predictions</span><span class="p">)</span>
</pre></div>
<div class="highlight">
<pre><span></span><span class="k">print</span><span class="p">(</span><span class="n">confusion</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">confusion</span><span class="p">[:</span><span class="mi">5</span><span class="p">,</span> <span class="p">:</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
<pre class="example">
(20, 20)
[[237   2   0   0   1]
 [  1 307  14   8   8]
 [  2  21 289  34  12]
 [  0  13  23 284  21]
 [  0   5   6  22 319]]

</pre>
<p>The confusion matrix has twenty rows and columns. The rows represent what classification our model predicted and the columns what they actually were - the diagonal is the count of the correctly classified documents. We could just print out the twenty by twenty matrix, but why not plot it instead?</p>
<div class="highlight">
<pre><span></span><span class="n">plot</span> <span class="o">=</span> <span class="n">holoviews</span><span class="o">.</span><span class="n">HeatMap</span><span class="p">((</span><span class="n">dataset</span><span class="o">.</span><span class="n">target_names</span><span class="p">,</span> 
                          <span class="n">dataset</span><span class="o">.</span><span class="n">target_names</span><span class="p">,</span> 
                          <span class="n">confusion</span><span class="p">))</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>                                              
                                              <span class="n">height</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
                                              <span class="n">xrotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span>
                                              <span class="n">tools</span><span class="o">=</span><span class="p">[</span><span class="s2">"hover"</span><span class="p">],</span>
                                              <span class="n">colorbar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span>
                                              <span class="n">title</span><span class="o">=</span><span class="s2">"Confusion Matrix"</span><span class="p">)</span>
<span class="n">Embed</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="n">plot</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"confusion_matrix"</span><span class="p">)()</span>
</pre></div>
<object data="confusion_matrix.html" height="800" style="width:100%" type="text/html">
<p>Figure Missing</p>
</object>
<p><b>Note To Future Self:</b> If you don't set the height and width holoviews will collapse the heatmap into an unviewable point, with only the axes visible (nice library but their documentation is <i>horrible</i>).</p>
<p>Surprisingly, HoloViews rotated the matrix, but it looks like the values are the same.</p>
<p>As you might expect, <i>talk.religion.misc</i>, <i>talk.politics.misc</i>, and <i>alt.atheism</i>, the three least represented groups in our training set have the least "heat". Surprisingly, <i>rec.sport.baseball</i> is the deepest red (has the highest value) while it is eleventh in the training set, and hockey, which is the most represented in the training set is sort of light. Maybe I should have tried to match the distributions when I did the train-test set split.</p>
<p>Anyway, since the groups aren't equally represented, the matches probably aren't as interesting as the misses.</p>
<div class="highlight">
<pre><span></span><span class="n">mask</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">confusion</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">numpy</span><span class="o">.</span><span class="n">fill_diagonal</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">most_confused</span> <span class="o">=</span> <span class="n">confusion</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">"Largest Confusion: {most_confused}"</span><span class="p">)</span>
</pre></div>
<pre class="example">
Largest Confusion: 95

</pre>
<p>The largest confusion was for <i>talk.political.guns</i> being confused for <i>talk.political.misc</i>, which doesn't seem that surprising, since guns are miscellaneously political. Let's try a top-five.</p>
<div class="highlight">
<pre><span></span><span class="n">top_five</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">confusion</span><span class="p">[</span><span class="n">mask</span><span class="p">])))[:</span><span class="mi">5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">top_five</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">" - {value}"</span><span class="p">)</span>
</pre></div>
<ul class="org-ul">
<li>95</li>
<li>43</li>
<li>41</li>
<li>39</li>
<li>38</li>
</ul>
<p>The remainders in the top five:</p>
<ul class="org-ul">
<li><i>comp.graphics</i> was mistaken for <i>comp.windows.x</i> (43)</li>
<li><i>soc.religion.christian</i> was mistaken for <i>talk.religion.misc</i> (41)</li>
<li><i>talk.religion.misc</i> was mistaken for <i>alt.atheism</i> (39)</li>
<li><i>comp.windows.x</i> was mistaken for <i>comp.os.ms-windows.misc</i> (38)</li>
</ul>
<p>In the dataset (as in life) the most confusisng seemed to be religion, politics, and computers, while the easiest to classify were sports and motorcycles (the rec categories). The <i>sci</i> categories did all right as well, although not as well as <i>rec</i> oddly (since I would have assumed they would have more identifying jargon).</p>
</div>
</div>
</div>
<div class="outline-2" id="outline-container-org7d45ad6">
<h2 id="org7d45ad6">End</h2>
<div class="outline-text-2" id="text-org7d45ad6">
<p>So here we have a basic walk-through using sklearn to model a document classifier built with Logistic Regression. One of the nice things about logistic regression is that the weights tell you which variables are the most important, but I've never tried that with documents so I don't know how to do that here. There are many improvements that could be made (would have to be made) if this were an attempt to make a real model, but the simplicity of the steps shows how much you can do with off-the-shelf software. Eighty-three percent isn't perfect, but it's pretty good.</p>
</div>
<div class="outline-3" id="outline-container-orga2b6c8e">
<h3 id="orga2b6c8e">Original Source</h3>
<div class="outline-text-3" id="text-orga2b6c8e">
<ol class="org-ol">
<li>Kasliwal N. Natural language processing with Python quick start guide: going from a Python developer to an effective natural language processing engineer [Internet]. 2018 [cited 2019 May 18]. Available from: <a href="http://proquest.safaribooksonline.com/?fpi=9781789130386">http://proquest.safaribooksonline.com/?fpi=9781789130386</a></li>
</ol>
</div>
</div>
</div>
</div>
<aside class="postpromonav">
<nav>
<ul class="tags" itemprop="keywords">
<li><a class="tag p-category" href="../../../categories/nlp/" rel="tag">nlp</a></li>
<li><a class="tag p-category" href="../../../categories/walk-through/" rel="tag">walk-through</a></li>
</ul>
<ul class="pager hidden-print">
<li class="previous"><a href="../../text_mining/the-vector-space-model/" rel="prev" title="The Vector Space Model">Previous post</a></li>
</ul>
</nav>
</aside>
</article>
<!--End of body content-->
<footer id="footer">Contents Â© 2019 <a href="mailto:necromuralist@protonmail.com">Cloistered Monkey</a> - Powered by <a href="https://getnikola.com" rel="nofollow">Nikola</a></footer>
</div>
</div>
<script src="../../../assets/js/all-nocdn.js"></script>
<script>

    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element) {
            return element.getElementsByTagName('img')[0].alt;
    }});
</script>
</body>
</html>
